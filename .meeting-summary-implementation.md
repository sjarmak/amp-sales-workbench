# Meeting Summary Agent Implementation

## Overview
Implemented AI Meeting Summary agent that extracts structured insights from Gong call transcripts with MEDDIC qualification signals.

## Files Created/Modified

### Core Agent
- **[src/agents/meetingSummary.ts](file:///Users/sjarmak/amp-sales-workbench/src/agents/meetingSummary.ts)** - Main agent implementation
  - Loads call transcripts from Gong cache or raw data
  - Uses Amp SDK `execute()` for AI extraction
  - Outputs JSON + Markdown summaries
  - Saves to `data/accounts/{slug}/meeting-summaries/`

### Type Definitions
- **[src/types.ts](file:///Users/sjarmak/amp-sales-workbench/src/types.ts)** - Added types (lines 537-564):
  - `MeetingSummary` - Top-level summary structure
  - `Stakeholder` - Attendee info with engagement level
  - `MEDDICHints` - 6 MEDDIC signals (Metrics, Economic Buyer, Decision Criteria, Decision Process, Pain, Champion)

### Prompt Template
- **[prompts/meeting-summary.md](file:///Users/sjarmak/amp-sales-workbench/prompts/meeting-summary.md)** - AI instruction template
  - Defines extraction logic for each field
  - Provides examples for MEDDIC signal detection
  - Specifies JSON output format

### API Integration
- **[api-server.ts](file:///Users/sjarmak/amp-sales-workbench/api-server.ts)** - Added endpoint:
  - `GET /api/accounts/:slug/meetings/:callId/summary` - Retrieve generated summary
  - Returns 404 if summary doesn't exist yet

### Agent Runner
- **[src/agents/agent-runner.ts](file:///Users/sjarmak/amp-sales-workbench/src/agents/agent-runner.ts)** - Integrated into unified agent system:
  - Added `meeting-summary` to `AgentName` type
  - Added case handler requiring `callId` parameter
  - Added metadata for agent discovery

### CLI Command
- **[scripts/test-meeting-summary.ts](file:///Users/sjarmak/amp-sales-workbench/scripts/test-meeting-summary.ts)** - CLI runner
- **[package.json](file:///Users/sjarmak/amp-sales-workbench/package.json)** - Added script:
  ```bash
  npm run meeting-summary "Account Name" [callId]
  ```

## Output Structure

### JSON (`meeting-summary-{callId}-{date}.json`)
```json
{
  "accountKey": { "name": "Acme Corp" },
  "callId": "call-12345",
  "callTitle": "Q4 Planning Session",
  "callDate": "2025-10-15T14:00:00Z",
  "objectives": [
    "Review Q4 roadmap",
    "Discuss implementation timeline"
  ],
  "blockers": [
    "Security review pending",
    "Budget approval delayed"
  ],
  "nextSteps": [
    "Schedule follow-up with security team",
    "Send pricing proposal by Friday"
  ],
  "stakeholders": [
    {
      "name": "Jane Smith",
      "role": "VP Engineering",
      "engagementLevel": "high",
      "keyComments": ["We need this by Q1", "Integration with Salesforce is critical"]
    }
  ],
  "meddicHints": {
    "metrics": ["Reduce manual work by 20 hours/week", "Save $50K annually"],
    "economicBuyer": ["CFO approval required", "Budget owner: Jane Smith"],
    "decisionCriteria": ["Must integrate with Salesforce", "SOC 2 compliance required"],
    "decisionProcess": ["3-week evaluation", "Security review", "Legal approval"],
    "identifyPain": ["Manual data entry is error-prone", "Slow reporting"],
    "champion": ["Jane: 'This solves our biggest problem'", "Strong internal advocate"]
  },
  "generatedAt": "2025-10-21T10:30:00Z"
}
```

### Markdown (`meeting-summary-{callId}-{date}.md`)
- Formatted sections with icons for MEDDIC hints
- Stakeholder engagement indicators (ðŸ”¥ high, âš¡ medium, ðŸ”µ low)
- Clean bullet lists for easy scanning

## Extraction Logic

### Transcript Loading
1. Check `.gong-cache/{callId}.json` first (cached transcripts)
2. Fallback to `raw/gong.json` for transcript + metadata
3. Error if transcript not found

### AI Extraction (via Amp SDK)
Prompt includes:
- Call title, date, Gong summary, topics
- Full transcript with speaker IDs
- Detailed instructions for each field
- MEDDIC signal examples (ROI = Metrics, CFO mention = Economic Buyer, etc.)

### MEDDIC Signal Detection
- **Metrics**: ROI, KPIs, quantifiable goals ("save 20 hours/week")
- **Economic Buyer**: Budget authority, CFO/VP mentions, approval power
- **Decision Criteria**: Requirements, must-haves, compliance needs
- **Decision Process**: Approval steps, timeline, committees
- **Identify Pain**: Problems, frustrations, business impact
- **Champion**: Enthusiasm ("I love this"), internal advocacy

## Usage

### CLI
```bash
# Generate summary for specific call
npm run meeting-summary "Acme Corp" "call-abc123"
```

### API
```bash
# Generate (via agent runner)
POST /api/agents/meeting-summary
{
  "accountName": "Acme Corp",
  "callId": "call-abc123"
}

# Retrieve existing summary
GET /api/accounts/acme-corp/meetings/call-abc123/summary
```

### Web UI Integration
Agent available in UI via `/api/agents/meeting-summary/stream` for real-time progress updates.

## Error Handling
- Validates `callId` is provided
- Throws error if transcript not found
- Graceful JSON parsing with fallback to text extraction
- Logs progress dots during AI generation

## Next Steps (Future Enhancements)
1. Auto-generate summaries after each Gong sync
2. Link summaries to Salesforce activities
3. Add "Summary Quality Score" (% of MEDDIC signals detected)
4. Bulk summarization for multiple calls
5. Compare summaries across time to detect trends
